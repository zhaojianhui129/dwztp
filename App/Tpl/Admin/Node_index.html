<h2 class="contentTitle">节点管理</h2>
<div class="pageContent layoutBox"  style="height:100%">

<div class="panelBar">
  <ul class="toolBar">
    <php>if( ishavepower('Node/patchAdd') ){</php><li><a class="add" href="{:U('Node/patchAdd')}" target="dialog" mask=true width="800" height="400"><span>批量添加</span></a></li><php>}</php>
  </ul>
</div>
<div id="node_box" style="float:left; display:block; margin:10px; overflow:auto; width:800px; height:550px; border:solid 1px #CCC; line-height:21px; background:#FFF;" layoutH="200">
  <ul class="tree treeFolder expand">
    <volist name="nodeList" id="vo">
      <li><a>{$vo.title}</a> <span>
      			<php>if( ishavepower('Node/sort') ){</php>
                <a target="ajaxTodo" title="顶置？" href="{:U('Node/sort',array('move'=>'top','id'=>$vo['id'],'pid'=>$vo['pid']) )}"><img src="__PUBLIC__/images/movetop.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="上移？" href="{:U('Node/sort',array('move'=>'up','id'=>$vo['id'],'pid'=>$vo['pid']) )}"><img src="__PUBLIC__/images/moveup.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="下移？" href="{:U('Node/sort',array('move'=>'down','id'=>$vo['id'],'pid'=>$vo['pid']) )}"><img src="__PUBLIC__/images/movedown.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="置末？" href="{:U('Node/sort',array('move'=>'bottom','id'=>$vo['id'],'pid'=>$vo['pid']) )}"><img src="__PUBLIC__/images/movebottom.gif" /></a>&nbsp;<php>}</php>              
                <php>if( ishavepower('Node/add') ){</php><a title="增加【{$vo.title}】子节点" target="dialog" mask=true height="315" width="600" href="{:U('Node/add',array('pid'=>$vo['id']))}" class="btnAdd">增加子节点</a><php>}</php>
                <php>if( ishavepower('Node/edit') ){</php><a title="编辑" target="dialog" mask=true href="{:U('Node/edit',array('id'=>$vo['id']))}" class="btnEdit">编辑</a><php>}</php>
                </span>
        <notempty name="vo._child">
          <ul>
            <volist name="vo._child" id="chivo1">
              <li><a>{$chivo1.title}</a> <span>
                <php>if( ishavepower('Node/sort') ){</php><a target="ajaxTodo" title="顶置？" href="{:U('Node/sort',array('move'=>'top','id'=>$chivo1['id'],'pid'=>$chivo1['pid']) )}"><img src="__PUBLIC__/images/movetop.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="上移？" href="{:U('Node/sort',array('move'=>'up','id'=>$chivo1['id'],'pid'=>$chivo1['pid']) )}"><img src="__PUBLIC__/images/moveup.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="下移？" href="{:U('Node/sort',array('move'=>'down','id'=>$chivo1['id'],'pid'=>$chivo1['pid']) )}"><img src="__PUBLIC__/images/movedown.gif" /></a>&nbsp;
                <a target="ajaxTodo" title="置末？" href="{:U('Node/sort',array('move'=>'bottom','id'=>$chivo1['id'],'pid'=>$chivo1['pid']) )}"><img src="__PUBLIC__/images/movebottom.gif" /></a>&nbsp;<php>}</php>
                
                <php>if( ishavepower('Node/add') ){</php><a title="增加【{$chivo1.title}】子节点" target="dialog" mask=true height="315" width="600" href="{:U('Node/add',array('pid'=>$chivo1['id']))}" class="btnAdd">增加子节点</a><php>}</php>
                <php>if( ishavepower('Node/edit') ){</php><a title="编辑" target="dialog" mask=true href="{:U('Node/edit',array('id'=>$chivo1['id']))}" class="btnEdit">编辑</a><php>}</php>
                <php>if( ishavepower('Node/del') ){</php><a title="你确定删除【{$chivo1.title}】节点吗？" target="ajaxTodo" href="{:U('Node/del',array('id'=>$chivo1['id']))}" class="btnDel">删除</a><php>}</php>
                </span>
                <notempty name="chivo1._child">
                  <ul>
                    <volist name="chivo1._child" id="chivo2">
                      <li><a>{$chivo2.title}</a> <span class="node3buttons">
                        <php>if( ishavepower('Node/sort') ){</php>
                        <a target="ajaxTodo" title="顶置？" href="{:U('Node/sort',array('move'=>'top','id'=>$chivo2['id'],'pid'=>$chivo2['pid']) )}"><img src="__PUBLIC__/images/movetop.gif" /></a>&nbsp;
                        <a target="ajaxTodo" title="上移？" href="{:U('Node/sort',array('move'=>'up','id'=>$chivo2['id'],'pid'=>$chivo2['pid']) )}"><img src="__PUBLIC__/images/moveup.gif" /></a>&nbsp;
                        <a target="ajaxTodo" title="下移？" href="{:U('Node/sort',array('move'=>'down','id'=>$chivo2['id'],'pid'=>$chivo2['pid']) )}"><img src="__PUBLIC__/images/movedown.gif" /></a>&nbsp;
                        <a target="ajaxTodo" title="置末？" href="{:U('Node/sort',array('move'=>'bottom','id'=>$chivo2['id'],'pid'=>$chivo2['pid']) )}"><img src="__PUBLIC__/images/movebottom.gif" /></a>&nbsp;<php>}</php>                      
                        <php>if( ishavepower('Node/edit') ){</php><a title="编辑" target="dialog" mask=true href="{:U('Node/edit',array('id'=>$chivo2['id']))}" class="btnEdit">编辑</a><php>}</php>
                        <php>if( ishavepower('Node/del') ){</php><a title="你确定要删除【{$chivo2.title}】节点吗？" target="ajaxTodo" href="{:U('Node/del',array('id'=>$chivo2['id']))}" class="btnDel">删除</a><php>}</php>
                        </span> </li>
                    </volist>
                  </ul>
                </notempty>
              </li>
            </volist>
          </ul>
        </notempty>
      </li>
    </volist>
  </ul>
   </div>
</div>

<style type="text/css">
#node_box li > div{width:61%;float:left;}
#node_box li > span{width:38%; float:right;}
#node_box li > span > a{ width:22px;float:left;}
</style>
<script type="text/javascript">
$(function(){
	//$(".node3buttons").prevAll("div").remove();
	});
</script>
